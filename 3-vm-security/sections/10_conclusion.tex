\section{Conclusion}
\label{sec:conclusion}

In this work, we presented a new DoS attack on Ethereum by exploiting the metering mechanism. We first re-executed the Ethereum blockchain for~\Months months and showed some significant inconsistencies in the pricing of the EVM instructions. We further explored various other design weaknesses, such as gas costs for arithmetic EVM instructions and cache dependencies on the execution time. Additionally, we demonstrated that there is very little correlation between gas and resources such as CPU and memory. We found that the main reason for this is that the gas price is dominated by the amount of \emph{storage} used.

Based on our observations, we presented a new attack called~\emph{Resource Exhaustion Attack} which systematically exploits these imperfections to generate low-throughput contracts. Our genetic algorithm can generate programs which exhibit a throughput of around~\empirical{1.25M} gas per second after a single generation. A minimum in our experiments is attained at generation~\empirical{243} with the block using around~\empirical{9.9M} gas and taking around~\empirical{93 seconds}.
We showed that we can generate contracts with throughput as low as~\empirical{107,000} gas per second, or on average more than~\Slowdown times slower than typical contracts, and that all major Ethereum clients are vulnerable. We argued that several attackers such as speculators, Ethereum competitors or even miners could have financial incentives to perform such an attack. Finally, we discussed short-term and potential long-term fixes for gas mispricing. Our attack went through a responsible disclosure process and has been awarded a bug bounty reward of 5,000~USD by the Ethereum foundation.
